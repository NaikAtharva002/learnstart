{"version":3,"sources":["../../../../../admin-panel/src/components/Modal.tsx","../../../../../admin-panel/src/app/tasks/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ReactNode } from 'react';\r\nimport { HiOutlineX } from 'react-icons/hi';\r\n\r\ninterface ModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    title: string;\r\n    children: ReactNode;\r\n    footer?: ReactNode;\r\n}\r\n\r\nexport default function Modal({ isOpen, onClose, title, children, footer }: ModalProps) {\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h3 className=\"modal-title\">{title}</h3>\r\n                    <button className=\"btn btn-icon btn-ghost\" onClick={onClose}>\r\n                        <HiOutlineX size={20} />\r\n                    </button>\r\n                </div>\r\n                <div className=\"modal-body\">\r\n                    {children}\r\n                </div>\r\n                {footer && (\r\n                    <div className=\"modal-footer\">\r\n                        {footer}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { getBusinesses, getPhasesByBusiness, getTasksByPhase, createTask, updateTask, deleteTask } from '@/lib/db';\r\nimport Modal from '@/components/Modal';\r\nimport { HiOutlinePlus, HiOutlinePencil, HiOutlineTrash } from 'react-icons/hi';\r\nimport type { Task, Business, Phase } from '@/lib/seed-data';\r\n\r\nexport default function AdminTasks() {\r\n    const [refresh, setRefresh] = useState(0);\r\n    const [businesses, setBusinesses] = useState<Business[]>([]);\r\n    const [selectedBiz, setSelectedBiz] = useState('');\r\n    const [phases, setPhases] = useState<Phase[]>([]);\r\n    const [selectedPhase, setSelectedPhase] = useState('');\r\n    const [tasks, setTasks] = useState<Task[]>([]);\r\n\r\n    useEffect(() => {\r\n        getBusinesses().then(bizs => {\r\n            setBusinesses(bizs);\r\n            if (bizs.length > 0 && !selectedBiz) {\r\n                setSelectedBiz(bizs[0].id);\r\n            }\r\n        });\r\n    }, [refresh, selectedBiz]);\r\n\r\n    useEffect(() => {\r\n        if (selectedBiz) {\r\n            getPhasesByBusiness(selectedBiz).then(phs => {\r\n                setPhases(phs);\r\n                if (phs.length > 0 && !phs.find(p => p.id === selectedPhase)) {\r\n                    setSelectedPhase(phs[0].id);\r\n                } else if (phs.length === 0) {\r\n                    setSelectedPhase('');\r\n                }\r\n            });\r\n        } else {\r\n            setPhases([]);\r\n            setSelectedPhase('');\r\n        }\r\n    }, [selectedBiz, refresh, selectedPhase]);\r\n\r\n    useEffect(() => {\r\n        if (selectedPhase) {\r\n            getTasksByPhase(selectedPhase).then(setTasks);\r\n        } else {\r\n            setTasks([]);\r\n        }\r\n    }, [selectedPhase, refresh]);\r\n\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [editing, setEditing] = useState<Task | null>(null);\r\n    const [form, setForm] = useState({ title: '', description: '', order: 1, phaseId: '' });\r\n\r\n    const openCreate = () => {\r\n        setEditing(null);\r\n        setForm({ title: '', description: '', order: tasks.length + 1, phaseId: selectedPhase });\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const openEdit = (task: Task) => {\r\n        setEditing(task);\r\n        setForm({ title: task.title, description: task.description, order: task.order, phaseId: task.phaseId });\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!form.title) return;\r\n        if (editing) {\r\n            await updateTask(editing.id, form);\r\n        } else {\r\n            await createTask(form);\r\n        }\r\n        setModalOpen(false);\r\n        setRefresh(r => r + 1);\r\n    };\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (confirm('Delete this task?')) {\r\n            await deleteTask(id);\r\n            setRefresh(r => r + 1);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"section-header\">\r\n                <div>\r\n                    <h1 className=\"section-title\">Tasks</h1>\r\n                    <p className=\"section-subtitle\">Manage action tasks for each phase</p>\r\n                </div>\r\n                <button className=\"btn btn-primary\" onClick={openCreate} disabled={!selectedPhase}>\r\n                    <HiOutlinePlus /> Add Task\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"flex gap-md mb-lg\" style={{ flexWrap: 'wrap' }}>\r\n                <select className=\"input select\" value={selectedBiz} onChange={(e) => setSelectedBiz(e.target.value)} style={{ width: 'auto', minWidth: '180px' }}>\r\n                    <option value=\"\">Select Business...</option>\r\n                    {businesses.map((b) => (\r\n                        <option key={b.id} value={b.id}>{b.icon} {b.name}</option>\r\n                    ))}\r\n                </select>\r\n                <select className=\"input select\" value={selectedPhase} onChange={(e) => setSelectedPhase(e.target.value)} style={{ width: 'auto', minWidth: '180px' }}>\r\n                    <option value=\"\">Select Phase...</option>\r\n                    {phases.map((p) => (\r\n                        <option key={p.id} value={p.id}>{p.name}</option>\r\n                    ))}\r\n                </select>\r\n            </div>\r\n\r\n            <div className=\"table-container\">\r\n                <table className=\"table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>#</th>\r\n                            <th>Title</th>\r\n                            <th>Description</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {tasks.map((task) => (\r\n                            <tr key={task.id}>\r\n                                <td>{task.order}</td>\r\n                                <td className=\"font-medium\">{task.title}</td>\r\n                                <td className=\"text-sm text-muted truncate\" style={{ maxWidth: '300px' }}>{task.description || '—'}</td>\r\n                                <td>\r\n                                    <div className=\"flex gap-xs\">\r\n                                        <button className=\"btn btn-ghost btn-sm\" onClick={() => openEdit(task)}>\r\n                                            <HiOutlinePencil />\r\n                                        </button>\r\n                                        <button className=\"btn btn-danger btn-sm\" onClick={() => handleDelete(task.id)}>\r\n                                            <HiOutlineTrash />\r\n                                        </button>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {tasks.length === 0 && (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">✅</div>\r\n                    <p className=\"empty-state-title\">No tasks in this phase</p>\r\n                    {selectedPhase && (\r\n                        <button className=\"btn btn-primary mt-md\" onClick={openCreate}>Add first task</button>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            <Modal\r\n                isOpen={modalOpen}\r\n                onClose={() => setModalOpen(false)}\r\n                title={editing ? 'Edit Task' : 'Create Task'}\r\n                footer={\r\n                    <>\r\n                        <button className=\"btn btn-secondary\" onClick={() => setModalOpen(false)}>Cancel</button>\r\n                        <button className=\"btn btn-primary\" onClick={handleSave}>Save</button>\r\n                    </>\r\n                }\r\n            >\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Title</label>\r\n                    <input className=\"input\" value={form.title} onChange={(e) => setForm({ ...form, title: e.target.value })} placeholder=\"e.g. Create your first proposal\" />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Description (optional)</label>\r\n                    <textarea className=\"input textarea\" value={form.description} onChange={(e) => setForm({ ...form, description: e.target.value })} />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Order</label>\r\n                    <input className=\"input\" type=\"number\" value={form.order} onChange={(e) => setForm({ ...form, order: parseInt(e.target.value) || 1 })} />\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"wDAGA,EAAA,EAAA,CAAA,CAAA,OAUe,SAAS,EAAM,QAAE,CAAM,SAAE,CAAO,OAAE,CAAK,UAAE,CAAQ,QAAE,CAAM,CAAc,SAClF,AAAK,EAGD,CAAA,CAHA,CAGA,EAAA,CAHS,EAGT,EAAC,MAAA,CAAI,UAAU,gBAAgB,QAAS,WACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,QAAQ,QAAS,AAAC,GAAM,EAAE,eAAe,aACpD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yBACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uBAAe,IAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,yBAAyB,QAAS,WAChD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,KAAM,UAG1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,sBACV,IAEJ,GACG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wBACV,SAhBD,IAsBxB,iEClCA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGe,SAAS,IACpB,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACjC,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EACrD,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACzC,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,EAAE,EAC1C,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7C,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAE,EAE7C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACN,CAAA,EAAA,EAAA,aAAA,AAAa,IAAG,IAAI,CAAC,IACjB,EAAc,GACV,EAAK,MAAM,CAAG,GAAK,CAAC,GACpB,EAAe,CAAI,CAAC,EAAE,CAAC,EAAE,CADQ,AAGzC,EACJ,EAAG,CAAC,EAAS,EAAY,EAEzB,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACF,EACA,CAAA,EAAA,EAAA,MADa,aACb,AAAmB,EAAC,GAAa,IAAI,CAAC,IAClC,EAAU,GACN,EAAI,MAAM,CAAG,GAAK,CAAC,EAAI,IAAI,CAAC,GAAK,EAAE,EAAE,GAAK,GAC1C,EAAiB,CAAG,CAAC,EAAE,CAAC,EAAE,EACJ,EAFoC,CAEjC,CAAlB,EAAI,MAAM,EACjB,EAAiB,GAEzB,IAEA,EAAU,EAAE,EACZ,EAAiB,IAEzB,EAAG,CAAC,EAAa,EAAS,EAAc,EAExC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACF,EACA,CAAA,EAAA,EAAA,QADe,OACf,AAAe,EAAC,GAAe,IAAI,CAAC,GAEpC,EAAS,EAAE,CAEnB,EAAG,CAAC,EAAe,EAAQ,EAE3B,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MAC9C,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAAE,MAAO,GAAI,YAAa,GAAI,MAAO,EAAG,QAAS,EAAG,GAE/E,EAAa,KACf,EAAW,MACX,EAAQ,CAAE,MAAO,GAAI,YAAa,GAAI,MAAO,EAAM,MAAM,CAAG,EAAG,QAAS,CAAc,GACtF,EAAa,GACjB,EAQM,EAAa,UACV,EAAK,KAAK,EAAE,CACb,EACA,MAAM,CADG,AACH,EAAA,EAAA,UAAA,AAAU,EAAC,EAAQ,EAAE,CAAE,GAE7B,MAAM,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GAErB,GAAa,GACb,EAAW,GAAK,EAAI,GACxB,EAEM,EAAe,MAAO,IACpB,QAAQ,sBAAsB,CAC9B,MAAM,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GACjB,EAAW,GAAK,EAAI,GAE5B,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACG,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yBAAgB,UAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,4BAAmB,0CAEpC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,kBAAkB,QAAS,EAAY,SAAU,CAAC,YAChE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,aAAa,CAAA,CAAA,GAAG,kBAIzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBAAoB,MAAO,CAAE,SAAU,MAAO,YACzD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,eAAe,MAAO,EAAa,SAAU,AAAC,GAAM,EAAe,EAAE,MAAM,CAAC,KAAK,EAAG,MAAO,CAAE,MAAO,OAAQ,SAAU,OAAQ,YAC5I,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,uBAChB,EAAW,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,WAAG,EAAE,IAAI,CAAC,IAAE,EAAE,IAAI,GAAnC,EAAE,EAAE,MAGzB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,eAAe,MAAO,EAAe,SAAU,AAAC,GAAM,EAAiB,EAAE,MAAM,CAAC,KAAK,EAAG,MAAO,CAAE,MAAO,OAAQ,SAAU,OAAQ,YAChJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,oBAChB,EAAO,GAAG,CAAC,AAAC,GACT,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAkB,MAAO,EAAE,EAAE,UAAG,EAAE,IAAI,EAA1B,EAAE,EAAE,SAK7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAU,kBACb,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UACG,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACG,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,MACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,UACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,gBACJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,iBAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,UACI,EAAM,GAAG,CAAC,AAAC,GACR,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,WACG,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,EAAK,KAAK,GACf,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uBAAe,EAAK,KAAK,GACvC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8BAA8B,MAAO,CAAE,SAAU,OAAQ,WAAI,EAAK,WAAW,EAAI,MAC/F,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UACG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,uBAAuB,QAAS,IAAM,CApExF,KACA,EAAQ,CAAE,GADC,GACM,EAAK,KAAK,CAAE,YAAa,EAAK,WAAW,CAAE,MAAO,AAmE8B,EAnEzB,KAAK,CAAE,QAAS,EAAK,OAAO,AAAC,GACrG,GAAa,aAmEuB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,eAAe,CAAA,CAAA,KAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,wBAAwB,QAAS,IAAM,EAAa,EAAK,EAAE,WACzE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAA,YAVtB,EAAK,EAAE,UAoBd,IAAjB,EAAM,MAAM,EACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4BAAmB,MAClC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6BAAoB,2BAChC,GACG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,wBAAwB,QAAS,WAAY,sBAK3E,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAK,CAAA,CACF,OAAQ,EACR,QAAS,IAAM,EAAa,IAC5B,MAAO,EAAU,YAAc,cAC/B,OACI,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,oBAAoB,QAAS,IAAM,GAAa,YAAQ,WAC1E,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,kBAAkB,QAAS,WAAY,sBAIjE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAa,UAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,QAAQ,MAAO,EAAK,KAAK,CAAE,SAAU,AAAC,GAAM,EAAQ,CAAE,GAAG,CAAI,CAAE,MAAO,EAAE,MAAM,CAAC,KAAM,AAAD,GAAK,YAAY,uCAE1H,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAa,2BAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CAAS,UAAU,iBAAiB,MAAO,EAAK,WAAW,CAAE,SAAU,AAAC,GAAM,EAAQ,CAAE,GAAG,CAAI,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,QAElI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,sBAAa,UAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,QAAQ,KAAK,SAAS,MAAO,EAAK,KAAK,CAAE,SAAU,AAAC,GAAM,EAAQ,CAAE,GAAG,CAAI,CAAE,MAAO,SAAS,EAAE,MAAM,CAAC,KAAK,GAAK,CAAE,aAKvJ"}