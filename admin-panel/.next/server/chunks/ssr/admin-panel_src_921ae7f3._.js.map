{"version":3,"sources":["../../../../../admin-panel/src/components/Modal.tsx","../../../../../admin-panel/src/app/phases/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { ReactNode } from 'react';\r\nimport { HiOutlineX } from 'react-icons/hi';\r\n\r\ninterface ModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    title: string;\r\n    children: ReactNode;\r\n    footer?: ReactNode;\r\n}\r\n\r\nexport default function Modal({ isOpen, onClose, title, children, footer }: ModalProps) {\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n            <div className=\"modal\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"modal-header\">\r\n                    <h3 className=\"modal-title\">{title}</h3>\r\n                    <button className=\"btn btn-icon btn-ghost\" onClick={onClose}>\r\n                        <HiOutlineX size={20} />\r\n                    </button>\r\n                </div>\r\n                <div className=\"modal-body\">\r\n                    {children}\r\n                </div>\r\n                {footer && (\r\n                    <div className=\"modal-footer\">\r\n                        {footer}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { getBusinesses, getPhasesByBusiness, createPhase, updatePhase, deletePhase } from '@/lib/db';\r\nimport Modal from '@/components/Modal';\r\nimport { HiOutlinePlus, HiOutlinePencil, HiOutlineTrash, HiOutlineArrowUp, HiOutlineArrowDown } from 'react-icons/hi';\r\nimport type { Phase, Business } from '@/lib/seed-data';\r\n\r\nexport default function AdminPhases() {\r\n    const [refresh, setRefresh] = useState(0);\r\n    const [businesses, setBusinesses] = useState<Business[]>([]);\r\n    const [selectedBiz, setSelectedBiz] = useState('');\r\n    const [phases, setPhases] = useState<Phase[]>([]);\r\n\r\n    useEffect(() => {\r\n        getBusinesses().then(bizs => {\r\n            setBusinesses(bizs);\r\n            if (bizs.length > 0 && !selectedBiz) {\r\n                setSelectedBiz(bizs[0].id);\r\n            }\r\n        });\r\n    }, [refresh, selectedBiz]);\r\n\r\n    useEffect(() => {\r\n        if (selectedBiz) {\r\n            getPhasesByBusiness(selectedBiz).then(setPhases);\r\n        } else {\r\n            setPhases([]);\r\n        }\r\n    }, [selectedBiz, refresh]);\r\n\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [editing, setEditing] = useState<Phase | null>(null);\r\n    const [form, setForm] = useState({ name: '', description: '', order: 1, businessId: '' });\r\n\r\n    const openCreate = () => {\r\n        setEditing(null);\r\n        setForm({ name: '', description: '', order: phases.length + 1, businessId: selectedBiz });\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const openEdit = (phase: Phase) => {\r\n        setEditing(phase);\r\n        setForm({ name: phase.name, description: phase.description, order: phase.order, businessId: phase.businessId });\r\n        setModalOpen(true);\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!form.name || !form.businessId) return;\r\n        if (editing) {\r\n            await updatePhase(editing.id, form);\r\n        } else {\r\n            await createPhase(form);\r\n        }\r\n        setModalOpen(false);\r\n        setRefresh(r => r + 1);\r\n    };\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (confirm('Delete this phase?')) {\r\n            await deletePhase(id);\r\n            setRefresh(r => r + 1);\r\n        }\r\n    };\r\n\r\n    const movePhase = async (phase: Phase, direction: 'up' | 'down') => {\r\n        const newOrder = direction === 'up' ? phase.order - 1 : phase.order + 1;\r\n        const swap = phases.find(p => p.order === newOrder);\r\n        if (swap) {\r\n            await updatePhase(swap.id, { order: phase.order });\r\n            await updatePhase(phase.id, { order: newOrder });\r\n            setRefresh(r => r + 1);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"section-header\">\r\n                <div>\r\n                    <h1 className=\"section-title\">Phases</h1>\r\n                    <p className=\"section-subtitle\">Manage roadmap phases for each business</p>\r\n                </div>\r\n                <button className=\"btn btn-primary\" onClick={openCreate}>\r\n                    <HiOutlinePlus /> Add Phase\r\n                </button>\r\n            </div>\r\n\r\n            {/* Business filter */}\r\n            <div className=\"mb-lg\">\r\n                <select\r\n                    className=\"input select\"\r\n                    value={selectedBiz}\r\n                    onChange={(e) => setSelectedBiz(e.target.value)}\r\n                    style={{ width: 'auto', minWidth: '200px' }}\r\n                >\r\n                    {businesses.map((b) => (\r\n                        <option key={b.id} value={b.id}>{b.icon} {b.name}</option>\r\n                    ))}\r\n                </select>\r\n            </div>\r\n\r\n            <div className=\"table-container\">\r\n                <table className=\"table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Order</th>\r\n                            <th>Name</th>\r\n                            <th>Description</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {phases.map((phase) => (\r\n                            <tr key={phase.id}>\r\n                                <td>{phase.order}</td>\r\n                                <td className=\"font-medium\">{phase.name}</td>\r\n                                <td className=\"text-sm text-muted truncate\" style={{ maxWidth: '300px' }}>{phase.description}</td>\r\n                                <td>\r\n                                    <div className=\"flex gap-xs\">\r\n                                        <button className=\"btn btn-ghost btn-sm\" onClick={() => movePhase(phase, 'up')} disabled={phase.order === 1}>\r\n                                            <HiOutlineArrowUp />\r\n                                        </button>\r\n                                        <button className=\"btn btn-ghost btn-sm\" onClick={() => movePhase(phase, 'down')} disabled={phase.order === phases.length}>\r\n                                            <HiOutlineArrowDown />\r\n                                        </button>\r\n                                        <button className=\"btn btn-ghost btn-sm\" onClick={() => openEdit(phase)}>\r\n                                            <HiOutlinePencil />\r\n                                        </button>\r\n                                        <button className=\"btn btn-danger btn-sm\" onClick={() => handleDelete(phase.id)}>\r\n                                            <HiOutlineTrash />\r\n                                        </button>\r\n                                    </div>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n            {phases.length === 0 && (\r\n                <div className=\"empty-state\">\r\n                    <div className=\"empty-state-icon\">ðŸš©</div>\r\n                    <p className=\"empty-state-title\">No phases found</p>\r\n                    {selectedBiz && (\r\n                        <button className=\"btn btn-primary mt-md\" onClick={openCreate}>Create the first phase</button>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            <Modal\r\n                isOpen={modalOpen}\r\n                onClose={() => setModalOpen(false)}\r\n                title={editing ? 'Edit Phase' : 'Create Phase'}\r\n                footer={\r\n                    <>\r\n                        <button className=\"btn btn-secondary\" onClick={() => setModalOpen(false)}>Cancel</button>\r\n                        <button className=\"btn btn-primary\" onClick={handleSave}>Save</button>\r\n                    </>\r\n                }\r\n            >\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Business</label>\r\n                    <select className=\"input select\" value={form.businessId} onChange={(e) => setForm({ ...form, businessId: e.target.value })}>\r\n                        {businesses.map((b) => (\r\n                            <option key={b.id} value={b.id}>{b.icon} {b.name}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Name</label>\r\n                    <input className=\"input\" value={form.name} onChange={(e) => setForm({ ...form, name: e.target.value })} placeholder=\"e.g. Foundation\" />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Description</label>\r\n                    <textarea className=\"input textarea\" value={form.description} onChange={(e) => setForm({ ...form, description: e.target.value })} />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <label className=\"form-label\">Order</label>\r\n                    <input className=\"input\" type=\"number\" value={form.order} onChange={(e) => setForm({ ...form, order: parseInt(e.target.value) || 1 })} />\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}